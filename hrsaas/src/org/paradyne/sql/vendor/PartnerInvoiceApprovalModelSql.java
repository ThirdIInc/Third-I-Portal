package org.paradyne.sql.vendor;
/**
 * @author ArchanaS
 */
import org.paradyne.lib.SqlBase;

public class PartnerInvoiceApprovalModelSql extends SqlBase{

	public String getQuery(int queryCode) {

		switch (queryCode) {

		case 1:
			return  " SELECT PARTNER_NAME,TO_CHAR(VENDOR_INVOICE.INVOICE_DATE, 'DD-MM-YYYY'),"
					+ " VENDOR_INFO.PARTNER_CODE, VENDOR_INVOICE.INVOICE_ID,VENDOR_INVOICE.INVOICE_STATUS"
					+ " FROM VENDOR_INVOICE"
					+ " INNER JOIN VENDOR_INFO ON (VENDOR_INFO.PARTNER_LOGIN_CODE = VENDOR_INVOICE.PARTNER_CODE)"
					+ " WHERE VENDOR_INVOICE.INVOICE_STATUS=?"
					+ " AND INVOICE_APPROVER =?";
		case 2:
			return "UPDATE VENDOR_INVOICE SET INVOICE_STATUS=? WHERE INVOICE_ID=?";
			
		case 3:
			return "UPDATE VENDOR_INVOICE SET INVOICE_STATUS=? , INVOICE_APPROVER=? ,INVOICE_LEVEL=? WHERE INVOICE_ID=?";
			
		case 4:
			return "INSERT INTO VENDOR_INVOICE_PATH(INVOICE_PATH_ID,INVOICE_APPL_ID,INVOICE_APPROVED_BY ,INVOICE_STATUS,"
					+" INVOICE_APPROVE_DATE, INVOICE_APPR_COMMENTS) "
					+" VALUES((SELECT NVL(MAX(INVOICE_PATH_ID),0)+1 FROM VENDOR_INVOICE_PATH),?,?,?,TO_DATE(TO_CHAR(SYSDATE,'DD-MM-YYYY'),'DD-MM-YYYY'),?)";  
			
		case 5:
			return "SELECT PARTNER_CODE, APPROVER_CODE, APPROVER_TYPE, APPROVER_LEVEL FROM VENDOR_REPORTING_STR "
			     +" WHERE APPROVER_TYPE='Mgr' AND APPROVER_LEVEL='1' AND PARTNER_CODE=? ";		
		default:
			return "Query not Found";

		}
	}
}
